# Cloud DFT Calculation Infrastructure

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è DFT —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ Google Cloud —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Å–µ—Ä–≤–µ—Ä–æ–≤.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
lib/cloud/
‚îú‚îÄ‚îÄ terraform/           # Terraform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ main.tf         # –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ variables.tf    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ outputs.tf      # –í—ã—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ containers/         # Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ dftb/          # DFTB+ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ calculate.py
‚îÇ   ‚îî‚îÄ‚îÄ orca/          # Orca –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îÇ       ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ       ‚îî‚îÄ‚îÄ calculate.py
‚îú‚îÄ‚îÄ scripts/           # –°–∫—Ä–∏–ø—Ç—ã –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ orchestrator.py # Cloud Function
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ cloud_runner.py    # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ cloudbuild.yaml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ setup.sh          # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îî‚îÄ‚îÄ README.md         # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
./setup.sh your-project-id us-central1
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏
cp /path/to/dftb+ containers/dftb/
cp -r /path/to/slakos containers/dftb/slakos/
cp /path/to/orca containers/orca/
cp -r /path/to/basis_sets containers/orca/basis_sets/

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
gcloud builds submit --config=cloudbuild.yaml .
```

### 3. –ó–∞–ø—É—Å–∫ —Ä–∞—Å—á–µ—Ç–∞

```bash
python3 cloud_runner.py \
  --project your-project-id \
  --bucket your-project-id-dft-calculations \
  --function-url https://your-function-url \
  --input molecule.xyz \
  --calculator dftb \
  --method relax \
  --cpu-count 128 \
  --cleanup
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã

### DFTB+
- `relax`: –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- `hessian`: –†–∞—Å—á–µ—Ç –º–∞—Ç—Ä–∏—Ü—ã –ì–µ—Å—Å–µ –∏ —á–∞—Å—Ç–æ—Ç
- `single`: –û–¥–Ω–æ—Ç–æ—á–µ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç

### Orca
- `opt-B3LYP-def2-SVP`: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å B3LYP/def2-SVP
- `hessian-B3LYP-def2-SVP`: –ß–∞—Å—Ç–æ—Ç—ã —Å B3LYP/def2-SVP  
- `single-M06-2X-def2-TZVP`: –û–¥–Ω–æ—Ç–æ—á–µ—á–Ω—ã–π —Å M06-2X/def2-TZVP

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. üì§ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –≤ Cloud Storage
2. üöÄ –ó–∞–ø—É—Å–∫–∞–µ—Ç Batch Job —Å preemptible –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
3. ‚è≥ –ñ–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–∞
4. üì• –°–∫–∞—á–∏–≤–∞–µ—Ç –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
5. üóëÔ∏è –£–¥–∞–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä (—Å —Ñ–ª–∞–≥–æ–º `--cleanup`)

## –°—Ç–æ–∏–º–æ—Å—Ç—å

–ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Ü–µ–Ω—ã –¥–ª—è 100 –∞—Ç–æ–º–æ–≤:
- **DFTB+ —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è**: $1-3 –∑–∞ —Ä–∞—Å—á–µ—Ç
- **DFT –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: $5-15 –∑–∞ —Ä–∞—Å—á–µ—Ç  
- **DFT –≥–µ—Å—Å–∏–∞–Ω**: $15-50 –∑–∞ —Ä–∞—Å—á–µ—Ç

*–° preemptible —Å–∫–∏–¥–∫–∞–º–∏ –¥–æ 80%*

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
gcloud batch jobs list --location=us-central1

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∑–∞–¥–∞—á–∏
gcloud batch jobs describe JOB_ID --location=us-central1

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–∞–π–ª—ã –≤ bucket
gsutil ls gs://your-bucket-name/
```

## –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
cd terraform
terraform destroy -auto-approve
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Job Failed
```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –∑–∞–¥–∞—á–∏
gcloud logging read "resource.type=batch_task" --limit=50
```

### Container Build Failed  
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞–º
ls -la containers/*/
```

### Download Failed
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ bucket
gsutil ls -la gs://your-bucket-name/outputs/
```